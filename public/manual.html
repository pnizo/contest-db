<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ユーザーマニュアル - Spreadsheet DB</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        .manual-container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 40px 20px;
            background: #fff;
        }
        .manual-header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 3px solid #4CAF50;
        }
        .manual-header h1 {
            color: #333;
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        .manual-toc {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 8px;
            margin-bottom: 40px;
        }
        .manual-toc h2 {
            color: #333;
            margin-top: 0;
            margin-bottom: 20px;
        }
        .manual-toc ol {
            line-height: 1.8;
        }
        .manual-toc a {
            color: #4CAF50;
            text-decoration: none;
        }
        .manual-toc a:hover {
            text-decoration: underline;
        }
        .manual-section {
            margin-bottom: 50px;
            padding: 30px;
            border-left: 4px solid #4CAF50;
            background: #fafafa;
        }
        .manual-section h2 {
            color: #4CAF50;
            font-size: 2em;
            margin-top: 0;
            margin-bottom: 20px;
        }
        .manual-section h3 {
            color: #333;
            font-size: 1.5em;
            margin-top: 30px;
            margin-bottom: 15px;
        }
        .manual-section h4 {
            color: #555;
            font-size: 1.2em;
            margin-top: 20px;
            margin-bottom: 10px;
        }
        .manual-section p, .manual-section li {
            line-height: 1.8;
            color: #555;
        }
        .manual-section ul, .manual-section ol {
            margin: 15px 0;
            padding-left: 30px;
        }
        .manual-section li {
            margin: 8px 0;
        }
        .manual-section strong {
            color: #333;
        }
        .manual-section code {
            background: #e8e8e8;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        .manual-section pre {
            background: #2d2d2d;
            color: #f8f8f8;
            padding: 20px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 20px 0;
        }
        .manual-section pre code {
            background: none;
            padding: 0;
            color: #f8f8f8;
        }
        .feature-badge {
            display: inline-block;
            background: #4CAF50;
            color: white;
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 0.85em;
            margin-left: 10px;
        }
        .admin-badge {
            background: #ff9800;
        }
        .checkmark {
            color: #4CAF50;
        }
        .crossmark {
            color: #f44336;
        }
        hr {
            border: none;
            border-top: 1px solid #ddd;
            margin: 40px 0;
        }
        .back-to-top {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #4CAF50;
            color: white;
            padding: 12px 20px;
            border-radius: 25px;
            text-decoration: none;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            transition: background 0.3s;
        }
        .back-to-top:hover {
            background: #45a049;
        }
    </style>
</head>
<body>
    <div class="manual-container">
        <div class="manual-header">
            <h1>📘 Spreadsheet DB ユーザーマニュアル</h1>
            <p>コンテスト成績データベース管理システム</p>
        </div>

        <div class="manual-toc" id="toc">
            <h2>目次</h2>
            <ol>
                <li><a href="#system-overview">システム概要</a></li>
                <li><a href="#login">ログイン</a></li>
                <li><a href="#users">ユーザー管理</a></li>
                <li>
                    <strong>大会運営</strong>
                    <ol type="a">
                        <li><a href="#registrations">出場登録</a></li>
                        <li><a href="#scores">大会成績</a></li>
                        <li><a href="#notes">特記事項</a></li>
                        <li><a href="#subjects">違反認定者</a><span class="feature-badge admin-badge">管理者のみ</span></li>
                        <li><a href="#contests">大会基本情報</a></li>
                    </ol>
                </li>
                <li>
                    <strong>入場管理</strong>
                    <ol type="a">
                        <li><a href="#tickets">チケット管理</a></li>
                        <li><a href="#guests">関係者チケット</a></li>
                    </ol>
                </li>
                <li>
                    <strong>Shopify検索</strong>
                    <ol type="a">
                        <li><a href="#members">FWJ会員検索</a></li>
                        <li><a href="#orders">注文検索</a></li>
                    </ol>
                </li>
                <li><a href="#permissions">権限について</a></li>
                <li><a href="#faq">よくある質問</a></li>
                <li><a href="#troubleshooting">トラブルシューティング</a></li>
                <li><a href="#requirements">システム要件</a></li>
            </ol>
        </div>

        <div class="manual-section" id="system-overview">
            <h2>システム概要</h2>
            
            <h3>概要</h3>
            <p>Spreadsheet DBは、Google Spreadsheetをデータベースとして使用するコンテスト成績管理システムです。フィットネス・ボディビル大会の選手情報、成績、出場登録、関係者情報などを一元管理できます。</p>
            
        </div>

        <div class="manual-section" id="login">
            <h2>ログイン</h2>
            
            <h3>ページ概要</h3>
            <p>システムの入り口となるログインページです。メールアドレスとパスワードで認証を行います。</p>
            
            <h3>アクセス方法</h3>
            <ul>
                <li>URL: <code>/</code> （ルートパス）</li>
            </ul>
            
            <h3>使い方</h3>
            
            <h4>1. ログイン手順</h4>
            <ol>
                <li>メールアドレスを入力</li>
                <li>パスワードを入力</li>
                <li>「ログイン」ボタンをクリック</li>
            </ol>
            
            <h4>2. ログイン後の動作</h4>
            <ul>
                <li><strong>認証成功時</strong>：JWTトークンがローカルストレージに保存され、自動的にユーザー一覧ページにリダイレクト</li>
                <li><strong>認証失敗時</strong>：エラーメッセージを表示</li>
            </ul>
            
            <h3>セキュリティ機能</h3>
            <ul>
                <li>パスワードは bcrypt でハッシュ化されて保存</li>
                <li>JWT トークンは24時間有効</li>
                <li>IP制限機能（管理者が設定可能）</li>
            </ul>
        </div>

        <div class="manual-section" id="users">
            <h2>ユーザー管理</h2>
            
            <h3>ページ概要</h3>
            <p>システムにアクセスするユーザーアカウントを管理するページです。管理者権限を持つユーザーのみが新規作成・編集・削除を実行できます。</p>
            
            <h3>アクセス方法</h3>
            <ul>
                <li>URL: <code>/users</code></li>
                <li>ナビゲーションバー：「ユーザー」リンク</li>
            </ul>
            
            <h3>主な機能</h3>
            
            <h4>1. ユーザー一覧表示</h4>
            <p><strong>表示項目</strong>：</p>
            <ul>
                <li>ユーザー名</li>
                <li>メールアドレス</li>
                <li>権限（admin / user）</li>
                <li>作成日時</li>
                <li>更新日時</li>
                <li>状態（有効 / 削除済み）</li>
            </ul>
            
            <h4>2. 新規ユーザー追加<span class="feature-badge admin-badge">管理者のみ</span></h4>
            <ol>
                <li>「新規ユーザー追加」ボタンをクリック</li>
                <li>以下の情報を入力：
                    <ul>
                        <li>ユーザー名</li>
                        <li>メールアドレス（一意である必要があります）</li>
                        <li>パスワード</li>
                        <li>権限（admin / user）</li>
                    </ul>
                </li>
                <li>「追加」ボタンをクリック</li>
            </ol>
            
            <h4>3. ユーザー編集<span class="feature-badge admin-badge">管理者のみ</span></h4>
            <ol>
                <li>編集したいユーザーの「編集」ボタンをクリック</li>
                <li>情報を修正</li>
                <li>「更新」ボタンをクリック</li>
            </ol>
            
            <h4>4. ユーザー削除<span class="feature-badge admin-badge">管理者のみ</span></h4>
            <ol>
                <li>削除したいユーザーの「削除」ボタンをクリック</li>
                <li>確認ダイアログで「OK」をクリック</li>
                <li>ユーザーは論理削除され、<code>isValid</code>フラグが<code>false</code>に設定されます</li>
            </ol>
            
            <h4>5. 削除済みユーザーの管理</h4>
            <ul>
                <li><strong>削除済み表示</strong>: 「削除済みを表示」ボタンで削除済みユーザーの表示/非表示を切り替え</li>
                <li><strong>復元</strong>: 削除済みユーザーの「復元」ボタンをクリック</li>
                <li><strong>完全削除</strong>: 削除済みユーザーの「完全削除」ボタンで物理削除（復元不可）</li>
            </ul>
            
            <h4>6. 自動復元機能</h4>
            <p>削除済みユーザーと同じメールアドレスで新規ユーザーを作成すると、自動的に既存のユーザーが復元されます。</p>
            
            <h3>一般ユーザーの制限</h3>
            <ul>
                <li>ユーザー一覧の閲覧のみ可能</li>
                <li>作成・編集・削除ボタンは非表示</li>
            </ul>
        </div>

        <div class="manual-section" id="registrations">
            <h2>出場登録</h2>

            <h3>ページ概要</h3>
            <p>大会への出場登録情報を管理するページです。選手のエントリー情報を一元管理できます。</p>

            <h3>アクセス方法</h3>
            <ul>
                <li>URL: <code>/registrations</code></li>
                <li>ナビゲーションバー：「大会運営」→「出場登録」</li>
            </ul>

            <h3>主な機能</h3>

            <h4>1. 登録一覧表示</h4>
            <p><strong>表示項目</strong>：</p>
            <ul>
                <li>氏名（漢字・カナ・ローマ字）</li>
                <li>大会名</li>
                <li>カテゴリー</li>
                <li>FWJカード番号</li>
                <li>エントリー番号</li>
                <li>出場順序</li>
                <li>登録日時</li>
                <li>状態</li>
            </ul>

            <h4>2. Shopifyインポート<span class="feature-badge admin-badge">管理者のみ</span></h4>
            <ol>
                <li>「Shopifyインポート」ボタンをクリック</li>
                <li>大会名を選択</li>
                <li>「最新のMembersをインポート」で会員データを同期</li>
                <li>「最新のエントリーをインポート」で注文データを取得</li>
                <li>「インポート実行」で出場登録データを作成</li>
            </ol>

            <h4>3. 開催順インポート<span class="feature-badge admin-badge">管理者のみ</span></h4>
            <ol>
                <li>「開催順インポート」ボタンをクリック</li>
                <li>大会名を選択</li>
                <li>CSVファイルを選択（class_name, score_card, contest_order列が必要）</li>
                <li>インポート実行</li>
            </ol>

            <h4>4. CSVエクスポート</h4>
            <ol>
                <li>「CSVエクスポート」ボタンをクリック</li>
                <li>対象大会を選択</li>
                <li>リストの種類を選択（ゼッケン表示用/全項目）</li>
                <li>CSVファイルとしてダウンロード</li>
            </ol>

            <h4>5. 検索・フィルタリング機能</h4>
            <ul>
                <li>氏名（漢字・カナ・ローマ字）で検索</li>
                <li>FWJカード番号でフィルタ</li>
                <li>大会名・クラス名でフィルタ</li>
                <li>ポリシー違反認定者のみ表示</li>
                <li>特記事項ありのみ表示</li>
            </ul>

            <h4>6. データ編集<span class="feature-badge admin-badge">管理者のみ</span></h4>
            <ul>
                <li>個別レコードの編集</li>
                <li>論理削除と復元</li>
            </ul>
        </div>

        <div class="manual-section" id="scores">
            <h2>大会成績</h2>

            <h3>ページ概要</h3>
            <p>フィットネス・ボディビル大会の選手成績を管理するページです。CSVファイルからの一括インポートに対応しています。</p>

            <h3>アクセス方法</h3>
            <ul>
                <li>URL: <code>/scores</code></li>
                <li>ナビゲーションバー：「大会運営」→「大会成績」</li>
            </ul>

            <h3>主な機能</h3>

            <h4>1. 成績一覧表示</h4>
            <p><strong>表示項目</strong>：</p>
            <ul>
                <li>FWJカード番号</li>
                <li>大会日</li>
                <li>大会名</li>
                <li>カテゴリー名</li>
                <li>選手名</li>
                <li>順位</li>
                <li>エントリー数</li>
                <li>ポイント</li>
                <li>状態（有効 / 削除済み）</li>
            </ul>

            <h4>2. CSVインポート</h4>
            <ol>
                <li>「インポート」ボタンをクリック</li>
                <li>大会を選択</li>
                <li>CSVファイルを選択（NPC Worldwide Results形式）</li>
                <li>「CSVをインポート」ボタンをクリック</li>
            </ol>

            <h4>3. 検索機能</h4>
            <ul>
                <li>検索ボックスに選手名を入力</li>
                <li>リアルタイムで結果を絞り込み</li>
                <li>「検索をクリア」ボタンで検索条件をリセット</li>
            </ul>

            <h4>4. フィルタリング機能</h4>
            <ul>
                <li><strong>FWJカード番号</strong>: 特定のカード番号で絞り込み</li>
                <li><strong>大会名</strong>: ドロップダウンから選択</li>
                <li><strong>カテゴリー名</strong>: ドロップダウンから選択</li>
                <li><strong>期間指定</strong>: 開始日と終了日で絞り込み</li>
            </ul>

            <h4>5. 成績削除<span class="feature-badge admin-badge">管理者のみ</span></h4>
            <ul>
                <li>論理削除方式で削除</li>
                <li>削除済み成績の表示/非表示切り替え可能</li>
                <li>削除済み成績の復元機能</li>
            </ul>
        </div>

        <div class="manual-section" id="notes">
            <h2>特記事項</h2>

            <h3>ページ概要</h3>
            <p>選手に関する特記事項を記録・管理するページです。欠席、クラス変更、チェックイン時刻変更などの情報を管理できます。</p>

            <h3>アクセス方法</h3>
            <ul>
                <li>URL: <code>/notes</code></li>
                <li>ナビゲーションバー：「大会運営」→「特記事項」</li>
            </ul>

            <h3>主な機能</h3>

            <h4>1. 特記事項一覧表示</h4>
            <p><strong>表示項目</strong>：</p>
            <ul>
                <li>コンテスト名・開催日</li>
                <li>ゼッケン番号</li>
                <li>FWJカード番号</li>
                <li>氏名</li>
                <li>登録内容（タイプ）</li>
                <li>詳細メモ</li>
                <li>記録日時</li>
            </ul>

            <h4>2. 新規追加</h4>
            <ol>
                <li>「新規追加」ボタンをクリック</li>
                <li>以下の情報を入力：
                    <ul>
                        <li>コンテスト名（必須）</li>
                        <li>ゼッケン番号またはFWJカード番号</li>
                        <li>氏名（必須）</li>
                        <li>登録内容（欠席、クラス変更、チェックイン時刻変更、当日クラス追加、FWJカード現地支払、帰宅、その他）</li>
                        <li>詳細メモ</li>
                    </ul>
                </li>
                <li>「出場登録データから検索して自動入力」で既存データから取得可能</li>
                <li>「保存」ボタンをクリック</li>
            </ol>

            <h4>3. 検索・フィルタリング機能</h4>
            <ul>
                <li>氏名で検索</li>
                <li>大会名・タイプでフィルタ</li>
                <li>期間指定でフィルタ</li>
            </ul>

            <h4>4. 編集・削除</h4>
            <ul>
                <li><strong>編集</strong>：該当レコードの「編集」ボタンから</li>
                <li><strong>削除</strong>：論理削除方式</li>
            </ul>
        </div>

        <div class="manual-section" id="subjects">
            <h2>違反認定者<span class="feature-badge admin-badge">管理者のみ</span></h2>

            <h3>ページ概要</h3>
            <p>アンチドーピング違反やその他の規約違反を認定された選手を管理するページです。<strong>管理者のみがアクセスできる機密情報</strong>を扱います。</p>

            <h3>アクセス方法</h3>
            <ul>
                <li>URL: <code>/subjects</code></li>
                <li>ナビゲーションバー：「大会運営」→「違反認定者」（管理者にのみ表示）</li>
            </ul>

            <h3>主な機能</h3>

            <h4>1. 違反認定者一覧表示</h4>
            <p><strong>表示項目</strong>：</p>
            <ul>
                <li>FWJカード番号</li>
                <li>日本語名</li>
                <li>英語名（姓・名）</li>
                <li>NPCメンバー番号</li>
                <li>備考</li>
                <li>状態（有効 / 削除済み）</li>
            </ul>

            <h4>2. 新規認定者追加</h4>
            <ol>
                <li>「新規認定者追加」ボタンをクリック</li>
                <li>以下の情報を入力：
                    <ul>
                        <li>FWJカード番号（必須）</li>
                        <li>日本語名（必須）</li>
                        <li>英語名（姓・名）（必須）</li>
                        <li>NPCメンバー番号（任意）</li>
                        <li>備考</li>
                    </ul>
                </li>
                <li>「認定者を追加」ボタンをクリック</li>
            </ol>

            <h4>3. 検索機能</h4>
            <ul>
                <li>氏名で検索</li>
            </ul>

            <h4>4. 削除と復元</h4>
            <ul>
                <li>論理削除方式</li>
                <li>「削除済みを表示」で削除済みデータの確認</li>
                <li>必要に応じて復元可能</li>
            </ul>

            <h3>セキュリティとプライバシー</h3>
            <ul>
                <li><strong>アクセス制限</strong>: 管理者のみアクセス可能</li>
                <li><strong>機密情報</strong>: 個人情報保護法に基づいた厳重管理</li>
            </ul>
        </div>

        <div class="manual-section" id="contests">
            <h2>大会基本情報</h2>

            <h3>ページ概要</h3>
            <p>大会の基本情報を管理するページです。開催日程、会場などの情報を登録・管理できます。</p>

            <h3>アクセス方法</h3>
            <ul>
                <li>URL: <code>/contests</code></li>
                <li>ナビゲーションバー：「大会運営」→「大会基本情報」</li>
            </ul>

            <h3>主な機能</h3>

            <h4>1. 大会一覧表示</h4>
            <p><strong>表示項目</strong>：</p>
            <ul>
                <li>大会名</li>
                <li>開催日</li>
                <li>開催地</li>
                <li>公開状態（FWJアプリ連携）</li>
            </ul>

            <h4>2. 新規大会追加</h4>
            <ol>
                <li>「新規追加」ボタンをクリック</li>
                <li>以下の情報を入力：
                    <ul>
                        <li>大会名（必須）</li>
                        <li>開催日</li>
                        <li>開催地</li>
                        <li>公開設定</li>
                    </ul>
                </li>
                <li>「保存」ボタンをクリック</li>
            </ol>

            <h4>3. 検索・フィルタリング</h4>
            <ul>
                <li><strong>検索</strong>: 大会名、開催地で検索</li>
                <li><strong>期間フィルター</strong>: 開始日〜終了日で絞り込み</li>
            </ul>

            <h4>4. 大会情報編集・削除</h4>
            <ul>
                <li>基本情報の編集</li>
                <li>削除（確認ダイアログあり）</li>
            </ul>
        </div>

        <div class="manual-section" id="tickets">
            <h2>チケット管理</h2>

            <h3>ページ概要</h3>
            <p>観戦チケットの管理を行うページです。Shopifyからインポートした観戦チケット情報を管理できます。</p>

            <h3>アクセス方法</h3>
            <ul>
                <li>URL: <code>/tickets</code></li>
                <li>ナビゲーションバー：「入場管理」→「チケット管理」</li>
            </ul>

            <h3>主な機能</h3>

            <h4>1. チケット一覧表示</h4>
            <p><strong>表示項目</strong>：</p>
            <ul>
                <li>注文番号</li>
                <li>注文日時</li>
                <li>購入者名</li>
                <li>商品名</li>
                <li>バリエーション</li>
                <li>指定席番号</li>
                <li>支払いステータス</li>
                <li>有効/無効</li>
            </ul>

            <h4>2. Shopifyインポート<span class="feature-badge admin-badge">管理者のみ</span></h4>
            <ol>
                <li>「Shopifyインポート」ボタンをクリック</li>
                <li>検索タグを設定（デフォルト：観戦チケット）</li>
                <li>取得期間（月数）を設定</li>
                <li>「インポート実行」ボタンをクリック</li>
            </ol>

            <h4>3. 検索・フィルタリング機能</h4>
            <ul>
                <li>氏名・メール・注文番号・座席番号で検索</li>
                <li>商品名・支払いステータス・Shopify IDでフィルタ</li>
                <li>有効のみ表示チェックボックス</li>
            </ul>

            <h4>4. チケット編集</h4>
            <ul>
                <li>有効/無効の切り替え</li>
                <li>所有者Shopify IDの変更（チケット譲渡用）</li>
                <li>指定席番号の設定</li>
            </ul>

            <h4>5. チケット削除</h4>
            <ul>
                <li>削除確認ダイアログ後に削除</li>
            </ul>
        </div>

        <div class="manual-section" id="guests">
            <h2>関係者チケット</h2>

            <h3>ページ概要</h3>
            <p>大会関係者のチケット配布・管理を行うページです。メディア、出展者、招待者などのチケット情報を管理できます。</p>

            <h3>アクセス方法</h3>
            <ul>
                <li>URL: <code>/guests</code></li>
                <li>ナビゲーションバー：「入場管理」→「関係者チケット」</li>
            </ul>

            <h3>主な機能</h3>

            <h4>1. チケット一覧表示</h4>
            <p><strong>表示項目</strong>：</p>
            <ul>
                <li>開催日・大会名</li>
                <li>チケット種別</li>
                <li>団体/個人</li>
                <li>付与パス</li>
                <li>代表者氏名</li>
                <li>団体名（企業名）</li>
                <li>申請種別</li>
                <li>合計付与枚数</li>
                <li>Check-In状態</li>
            </ul>

            <h4>2. 新規追加</h4>
            <ol>
                <li>「新規追加」ボタンをクリック</li>
                <li>以下の情報を入力：
                    <ul>
                        <li>大会名</li>
                        <li>チケット種別（関係者席、前売各種席）</li>
                        <li>団体/個人</li>
                        <li>付与パス（関係者パス、撮影者パス、出展者パス、GUESTパス）</li>
                        <li>代表者氏名（必須）</li>
                        <li>団体名、連絡先、担当者名</li>
                        <li>申請種別（メディア、出展者、招待、その他）</li>
                        <li>合計付与枚数</li>
                        <li>備考欄（同伴者氏名など）</li>
                    </ul>
                </li>
                <li>「保存」ボタンをクリック</li>
            </ol>

            <h4>3. 検索・フィルタリング機能</h4>
            <ul>
                <li>代表者氏名・団体名で検索</li>
                <li>大会名でフィルタ</li>
                <li>団体/個人でフィルタ</li>
                <li>付与パスでフィルタ</li>
            </ul>

            <h4>4. ステータス管理</h4>
            <ul>
                <li>事前案内メール送信チェック</li>
                <li>Check-Inチェック</li>
                <li>開催後メール送信チェック</li>
            </ul>
        </div>

        <div class="manual-section" id="members">
            <h2>FWJ会員検索</h2>

            <h3>ページ概要</h3>
            <p>FWJ（Fitness World Japan）の会員情報を検索するページです。Shopifyと連携して会員データを同期できます。読み取り専用で、編集はShopify管理画面から行います。</p>

            <h3>アクセス方法</h3>
            <ul>
                <li>URL: <code>/members</code></li>
                <li>ナビゲーションバー：「Shopify検索」→「FWJ会員検索」</li>
            </ul>

            <h3>主な機能</h3>

            <h4>1. 会員一覧表示</h4>
            <p><strong>表示項目</strong>：</p>
            <ul>
                <li>Shopify ID</li>
                <li>FWJカード番号</li>
                <li>氏名</li>
                <li>メールアドレス</li>
                <li>電話番号</li>
                <li>会員ステータス</li>
            </ul>
            <p><strong>注意</strong>: 「FWJカード会員」タグが付いている会員のみ表示されます。</p>

            <h4>2. Shopify同期<span class="feature-badge admin-badge">管理者のみ</span></h4>
            <ol>
                <li>「Shopifyから同期」ボタンをクリック</li>
                <li>Shopify APIから最新の会員データを取得</li>
                <li>Membersシートを更新</li>
            </ol>

            <h4>3. 検索機能</h4>
            <ul>
                <li>メールアドレスで検索</li>
                <li>氏名で検索</li>
            </ul>
        </div>

        <div class="manual-section" id="orders">
            <h2>注文検索</h2>

            <h3>ページ概要</h3>
            <p>Shopifyの注文を検索してスプレッドシートに出力するページです。商品タイプやタグで注文を絞り込めます。</p>

            <h3>アクセス方法</h3>
            <ul>
                <li>URL: <code>/orders</code></li>
                <li>ナビゲーションバー：「Shopify検索」→「注文検索」</li>
            </ul>

            <h3>主な機能</h3>

            <h4>1. 注文検索</h4>
            <ol>
                <li>商品タイプを入力（任意、例：コンテストエントリー）</li>
                <li>注文タグを入力（任意、複数タグはAND検索）</li>
                <li>「支払済の注文のみ検索する」チェックボックスで絞り込み</li>
                <li>「検索」ボタンをクリック</li>
            </ol>

            <h4>2. 検索結果の表示</h4>
            <p><strong>表示項目</strong>：</p>
            <ul>
                <li>注文番号</li>
                <li>注文日時</li>
                <li>購入者名</li>
                <li>商品名</li>
                <li>バリエーション</li>
                <li>数量</li>
                <li>支払いステータス</li>
            </ul>

            <h4>3. 現在のDBデータ表示</h4>
            <ul>
                <li>保存データ数</li>
                <li>最終検索日時</li>
                <li>検索商品タイプ</li>
                <li>検索タグ</li>
            </ul>

            <h3>注意事項</h3>
            <ul>
                <li>キャンセル済み・アーカイブ済みの注文は除外されます</li>
                <li>1つの注文に複数商品がある場合、商品ごとに行が展開されます</li>
                <li>タグ指定で引用符を使うとスペース含むタグを指定可能</li>
            </ul>
        </div>

        <div class="manual-section" id="permissions">
            <h2>権限について</h2>
            
            <h3>ユーザー権限の種類</h3>
            
            <h4>管理者（Admin）</h4>
            <p><strong>全機能の利用が可能</strong>：</p>
            <ul>
                <li><span class="checkmark">✅</span> 全ページへのアクセス</li>
                <li><span class="checkmark">✅</span> データの作成（Create）</li>
                <li><span class="checkmark">✅</span> データの読み取り（Read）</li>
                <li><span class="checkmark">✅</span> データの更新（Update）</li>
                <li><span class="checkmark">✅</span> データの削除（Delete）</li>
                <li><span class="checkmark">✅</span> CSVインポート/エクスポート</li>
                <li><span class="checkmark">✅</span> 削除済みデータの復元・完全削除</li>
                <li><span class="checkmark">✅</span> ユーザー管理</li>
                <li><span class="checkmark">✅</span> 違反認定者情報へのアクセス</li>
                <li><span class="checkmark">✅</span> Shopify同期機能</li>
            </ul>
            
            <h4>一般ユーザー（User）</h4>
            <p><strong>閲覧とCSVインポートのみ可能</strong>：</p>
            <ul>
                <li><span class="checkmark">✅</span> 全ページへのアクセス（違反認定者ページを除く）</li>
                <li><span class="checkmark">✅</span> データの読み取り（Read）</li>
                <li><span class="checkmark">✅</span> CSVインポート（大会成績、出場登録）</li>
                <li><span class="checkmark">✅</span> 検索・フィルタリング</li>
                <li><span class="crossmark">❌</span> データの作成・更新・削除</li>
                <li><span class="crossmark">❌</span> ユーザー管理</li>
                <li><span class="crossmark">❌</span> 削除済みデータの復元</li>
                <li><span class="crossmark">❌</span> 違反認定者情報へのアクセス</li>
                <li><span class="crossmark">❌</span> Shopify同期機能</li>
            </ul>
            
            <h3>権限による表示制御</h3>
            <ul>
                <li>一般ユーザーがアクセスした場合、作成・編集・削除ボタンは自動的に非表示</li>
                <li>「違反認定者」ナビゲーションリンクは管理者にのみ表示</li>
                <li>管理者専用機能には <code>.admin-only</code> クラスが付与され、CSS で制御</li>
            </ul>
        </div>

        <div class="manual-section" id="faq">
            <h2>よくある質問（FAQ）</h2>
            
            <h3>Q1: パスワードを忘れた場合は？</h3>
            <p>A: 現在、管理者に連絡してパスワードリセットを依頼してください。将来的にパスワードリセット機能の追加を予定しています。</p>
            
            <h3>Q2: CSVインポートでエラーが出る</h3>
            <p>A: 以下を確認してください：</p>
            <ul>
                <li>CSVファイルの文字コードが UTF-8 であること</li>
                <li>ヘッダー行が正しい形式であること</li>
                <li>必須項目が全て入力されていること</li>
                <li>日付形式が <code>YYYY-MM-DD</code> であること</li>
            </ul>
            
            <h3>Q3: 削除したデータは復元できますか？</h3>
            <p>A: はい。論理削除方式を採用しているため、管理者は削除済みデータを復元できます。ただし、「完全削除」を実行した場合は復元できません。</p>
            
            <h3>Q4: スマートフォンでも使えますか？</h3>
            <p>A: はい。レスポンシブデザインを採用しており、スマートフォンやタブレットでも利用できます。</p>
            
            <h3>Q5: データのバックアップは？</h3>
            <p>A: Google Spreadsheet上にデータが保存されているため、Google の自動バックアップ機能が有効です。また、定期的な CSV エクスポートをお勧めします。</p>
            
            <h3>Q6: 複数のユーザーが同時に編集できますか？</h3>
            <p>A: はい。ただし、同じレコードを同時に編集した場合、最後に保存した内容が反映されます（Last Write Wins）。</p>
        </div>

        <div class="manual-section" id="troubleshooting">
            <h2>トラブルシューティング</h2>
            
            <h3>ログインできない</h3>
            <ul>
                <li>メールアドレスとパスワードが正しいか確認</li>
                <li>ブラウザのキャッシュをクリア</li>
                <li>JWT トークンの有効期限切れの可能性（再ログイン）</li>
            </ul>
            
            <h3>データが表示されない</h3>
            <ul>
                <li>インターネット接続を確認</li>
                <li>Google Sheets API の接続状態を確認</li>
                <li>ブラウザのコンソールでエラーログを確認</li>
                <li>ページをリロード</li>
            </ul>
            
            <h3>CSVインポートが失敗する</h3>
            <ul>
                <li>ファイルサイズが大きすぎる（50MB制限）</li>
                <li>CSV形式が正しいか確認</li>
                <li>ネットワークの安定性を確認</li>
            </ul>
            
            <h3>権限エラーが表示される</h3>
            <ul>
                <li>自分のユーザー権限を確認</li>
                <li>管理者のみの機能にアクセスしていないか確認</li>
                <li>セッションの有効期限切れ（再ログイン）</li>
            </ul>
        </div>

        <div class="manual-section" id="requirements">
            <h2>システム要件</h2>
            
            <h3>ブラウザ</h3>
            <ul>
                <li>Google Chrome（推奨）</li>
                <li>Firefox</li>
                <li>Safari</li>
                <li>Microsoft Edge</li>
            </ul>
            
            <h3>ネットワーク</h3>
            <ul>
                <li>インターネット接続必須</li>
                <li>Google Sheets API へのアクセス権限</li>
            </ul>
            
            <h3>推奨環境</h3>
            <ul>
                <li>画面解像度: 1280x720 以上</li>
                <li>安定したインターネット接続</li>
                <li>最新版ブラウザの使用</li>
            </ul>
        </div>

        <hr>

        <div style="text-align: center; margin: 40px 0; color: #666;">
            <p><strong>Document Version</strong>: 2.0</p>
            <p><strong>Last Updated</strong>: 2026年1月28日</p>
            <p style="margin-top: 20px;">本マニュアルに記載されていない内容や、使い方で不明な点がある場合は、<br>システム管理者にお問い合わせください。</p>
        </div>
    </div>

    <a href="#toc" class="back-to-top">↑ トップへ</a>
</body>
</html>
